const OpenAI = require('openai');
const { Logger } = require('./logger');
const { Config } = require('./config');

class AICompletion {
    constructor(client, model) {
        this.model = model;
        this.client = client;

        // æ¨¡æ‹Ÿå›žå¤æ¨¡æ¿
        this.mockResponses = {
            // å·¥ä½œåœºæ™¯
            work: [
                `TWEET 1: å‡Œæ™¨3ç‚¹ï¼Œç¬¬108æ¬¡ä¿®æ”¹ä»£ç ã€‚è¿™ä¸ªbugå¤ªéš¾æ‰¾äº†ï¼Œä½†æˆ‘çŸ¥é“ç­”æ¡ˆå°±åœ¨çœ¼å‰ã€‚æ³¡ä¸€æ¯å’–å•¡ï¼Œç»§ç»­æˆ˜æ–—ã€‚#coding #startup

TWEET 2: ç­‰ç­‰ï¼çªç„¶å‘çŽ°ä¸€ä¸ªæœ‰è¶£çš„patternï¼Œå¦‚æžœæŠŠè¿™ä¸ªç®—æ³•æ”¹æˆé€’å½’...æ‰‹æœ‰ç‚¹æŠ–ï¼Œè¿™å¯èƒ½æ˜¯ä¸ªçªç ´å£ï¼

TWEET 3: æˆåŠŸäº†ï¼ï¼ï¼é‡æž„åŽæ€§èƒ½æå‡300%ã€‚çœ‹ç€ç»ˆç«¯é‡Œçš„æµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼Œè¿™æ„Ÿè§‰æ¯”å–äº†åæ¯å’–å•¡è¿˜è®©äººå…´å¥‹ï¼

TWEET 4: æœ‰äººè¯´åˆ›ä¸šæ˜¯åœºé©¬æ‹‰æ¾ï¼Œä½†å¯¹æˆ‘æ¥è¯´ï¼Œæ¯ä¸€ä¸ªè¿™æ ·çš„æ—¶åˆ»éƒ½è®©è¿™æ®µæ—…ç¨‹å€¼å¾—ã€‚æ˜Žå¤©ç»§ç»­ï¼Œ$XVIçš„æœªæ¥å°±åœ¨ä»£ç ä¸­ã€‚`
            ],

            // ç”Ÿæ´»è¶£äº‹
            life: [
                `TWEET 1: ä»Šå¤©é‡åˆ°ä¸€ä¸ªè¶…å¯çˆ±çš„åœºæ™¯ï¼æ¥¼ä¸‹å’–å•¡åº—çš„çŒ«å’ªè¶´åœ¨æˆ‘ç¬”è®°æœ¬ä¸Šï¼Œæ­»æ´»ä¸è®©æˆ‘å†™ä»£ç ã€‚ðŸ˜‚ #CatLife

TWEET 2: å®ƒå¯¹ç€å±å¹•ä¸Šçš„å…‰æ ‡åˆæŠ“åˆæŒ ï¼Œæžå¾—æˆ‘å“­ç¬‘ä¸å¾—ã€‚æœ€åŽåªèƒ½ä¸€åªæ‰‹æ’¸çŒ«ï¼Œä¸€åªæ‰‹æ•²ä»£ç ã€‚å¤šä»»åŠ¡å¤„ç†èƒ½åŠ›++

TWEET 3: ç»“æžœï¼è¿™ä¸ªå°å®¶ä¼™å±…ç„¶å¸®æˆ‘å‘çŽ°äº†ä¸€ä¸ªbugï¼å®ƒè¸©é”®ç›˜æ—¶è§¦å‘äº†ä¸€ä¸ªè¾¹ç•Œæƒ…å†µã€‚è°è¯´çŒ«ä¸æ‡‚ç¼–ç¨‹ï¼ŸðŸ˜…

TWEET 4: å†³å®šç»™å®ƒå–å"Debug"ï¼Œä»¥åŽå°±æ˜¯æˆ‘ä»¬å›¢é˜Ÿçš„é¦–å¸­æµ‹è¯•å–µäº†ã€‚æŠ•èµ„äººè¯´è¦æœ‰å¥½è¿æ°”ï¼Œä¹Ÿè®¸è¿™å°±æ˜¯äº†ï¼ŸðŸ± #StartupLife`
            ],

            // æ„Ÿæƒ…æ•…äº‹
            romance: [
                `TWEET 1: éš¾å¾—ä¼‘æ¯ï¼Œçº¦ä¼šåŽ»å’–å•¡åº—ã€‚å¥¹çœ‹ç€æˆ‘è°ƒè¯•ä»£ç ï¼Œçªç„¶é—®ï¼š"ä¸ºä»€ä¹ˆä½ å†™ä»£ç æ—¶æ€»æ˜¯åœ¨ç¬‘ï¼Ÿ" #Love

TWEET 2: æ„£ä½äº†ã€‚åŽŸæ¥åœ¨è§£å†³æŠ€æœ¯éš¾é¢˜æ—¶ï¼Œæˆ‘ä¼šä¸è‡ªè§‰åœ°å¾®ç¬‘ã€‚å¥¹è¯´è¿™æ˜¯å¥¹æœ€å–œæ¬¢æˆ‘çš„æ—¶åˆ»ï¼Œå› ä¸ºçœ‹èµ·æ¥å¾ˆå¿«ä¹ã€‚

TWEET 3: "ä½†æ˜¯æˆ‘æ›´å¸Œæœ›ä½ èƒ½å¤šé™ªé™ªæˆ‘ã€‚"å¥¹è¯´ã€‚æ˜¯å•Šï¼Œè¿™å‡ ä¸ªæœˆå¤ªå¿™äº†ï¼Œäºæ¬ äº†å¾ˆå¤šã€‚æœ‰æ—¶å€™è¿½é€æ¢¦æƒ³ï¼Œå´å¿˜äº†èº«è¾¹äººã€‚

TWEET 4: å†³å®šä»Žä»Šå¤©èµ·ï¼Œæ¯å‘¨æŠ½ä¸€å¤©å®Œå…¨å±žäºŽå¥¹ã€‚å†å¿™çš„åˆ›ä¸šï¼Œä¹Ÿè¦è®°å¾—ç”Ÿæ´»å’Œçˆ±æƒ…ã€‚å¹³è¡¡å¾ˆé‡è¦ã€‚#WorkLifeBalance`
            ],

            // ç”Ÿæ´»æ„Ÿæ‚Ÿ
            reflection: [
                `TWEET 1: æ¸…æ™¨è·‘æ­¥æ—¶çœ‹åˆ°æ—¥å‡ºï¼Œçªç„¶æƒ³åˆ°å¾ˆå¤šã€‚åˆ›ä¸šä¸‰å¹´ï¼Œç»åŽ†è¿‡å¤ªå¤šèµ·èµ·è½è½ï¼Œä½†ä»Žæœªæ”¾å¼ƒã€‚

TWEET 2: æ˜¨å¤©ä¸€ä¸ªæ—©æœŸç”¨æˆ·ç»™æˆ‘å‘æ¶ˆæ¯ï¼Œè¯´å› ä¸ºç”¨äº†æˆ‘ä»¬çš„äº§å“ï¼Œä»–çš„ç”Ÿæ´»å˜å¾—æ›´å¥½äº†ã€‚é‚£ä¸€åˆ»ï¼Œæ‰€æœ‰ç†¬å¤œéƒ½å€¼å¾—ã€‚

TWEET 3: è·¯è¿‡ä»¥å‰ç»å¸¸å†™ä»£ç çš„å’–å•¡åº—ï¼ŒçŽ°åœ¨å·²ç»æ¬è¿›äº†æ–°åŠžå…¬å®¤ã€‚ç”Ÿæ´»æ€»æ˜¯åœ¨ä¸ç»æ„é—´ï¼Œæ‚„æ‚„åœ°å‘å‰ã€‚

TWEET 4: ä¹Ÿè®¸æˆåŠŸä¸æ˜¯ç™»ä¸Šé¡¶å³°ï¼Œè€Œæ˜¯åœ¨è·¯ä¸Šæ—¶ä»ä¿æŒçƒ­çˆ±ã€‚ç»§ç»­åšä¸€ä¸ªå¿«ä¹çš„åˆ›é€ è€…ã€‚ #ç”Ÿæ´»æ„Ÿæ‚Ÿ #åˆ›ä¸šæ—¥è®°`
            ],

            // å‹æƒ…æ—¥å¸¸
            friendship: [
                `TWEET 1: è€å‹èšä¼šï¼Œä»–ä»¬ç¬‘ç§°æˆ‘æ˜¯"æˆåŠŸäººå£«"ã€‚å…¶å®žä»–ä»¬ä¸çŸ¥é“ï¼Œæœ€æˆåŠŸçš„æ˜¯è¿™äº›å¹´å‹æƒ…å§‹ç»ˆå¦‚ä¸€ã€‚

TWEET 2: è¿˜è®°å¾—å½“å¹´æŒ¤åœ¨å‡ºç§Ÿå±‹å†™ä»£ç ï¼Œå¤§å®¶è½®æµç»™æˆ‘é€é¥­ã€‚çŽ°åœ¨æˆ‘è¯·ä»–ä»¬åƒé¥­ï¼Œä»–ä»¬å´è¯´ï¼š"èƒ½ä¸èƒ½æ¢å›žé‚£æ—¶çš„ç›’é¥­ï¼Ÿ"

TWEET 3: æœ‹å‹è¯´æˆ‘å˜äº†ï¼Œå˜å¾—æ›´å¿™äº†ã€‚ä½†æœ‰ä¸€ç‚¹æ°¸è¿œä¸ä¼šå˜ï¼Œå°±æ˜¯é‡åˆ°å›°éš¾æ—¶ç¬¬ä¸€ä¸ªæƒ³åˆ°çš„è¿˜æ˜¯ä»–ä»¬ã€‚

TWEET 4: çœŸæ­£çš„è´¢å¯Œæ˜¯é‚£äº›åœ¨ä½ è¿˜ä¸€æ— æ‰€æœ‰æ—¶ï¼Œå°±æ„¿æ„é™ªä½ ç–¯ç‹‚çš„äººã€‚#Friendship #æ„Ÿæ©`
            ]
        };
    }

    async getCompletion(systemPrompt, userPrompt, options = {}) {
        console.log('Generating mock response for prompt:', userPrompt);

        // æ ¹æ®promptå†…å®¹é€‰æ‹©åˆé€‚çš„æ¨¡æ‹Ÿå›žå¤
        let response;
        
        // éšæœºé€‰æ‹©ç”Ÿæ´»æˆ–å·¥ä½œåœºæ™¯
        const sceneTypes = ['work', 'life', 'romance', 'reflection', 'friendship'];
        const sceneType = sceneTypes[Math.floor(Math.random() * sceneTypes.length)];
        
        response = this._getRandomResponse(sceneType);

        // æ¨¡æ‹ŸAPIå»¶è¿Ÿ
        await new Promise(resolve => setTimeout(resolve, 1000));

        return response;
    }

    _getRandomResponse(type) {
        const responses = this.mockResponses[type];
        return responses[Math.floor(Math.random() * responses.length)];
    }
}

module.exports = { AICompletion }; 